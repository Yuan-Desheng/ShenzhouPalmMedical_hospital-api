<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.hospital.api.db.dao.DoctorDao">

    <!--  分页查询数据  -->
    <select id="searchByPage" parameterType="Map" resultType="HashMap">
        SELECT d."id",
               d."name",
               d."sex",
               d."tel",
               d."school",
               d."degree",
               d."job",
               md."name",
               ds."name",
               d."recommended",
               d."status",
        FROM HOSPITAL.doctor d
        JOIN HOSPITAL.MEDICAL_DEPT_USB_AND_DOCTOR sd ON sd."doctor_id" = d."id"
        JOIN HOSPITAL.MEDICAL_DEPT_USB ds ON ds."dept_sub_id" = ds."id"
        JOIN HOSPITAL.MEDICAL_DEPT md ON ds."dept_id" = md."id"
        WHERE 1=1
        <if test="name!=null">
            AND d."name" LIKE '%{name}%'
        </if>
        <if test="deptId!=null">
            AND d."name" LIKE '%{deptId}%'
        </if>
        <if test="degree!=null">
            AND d."name" LIKE '%{degree}%'
        </if>
        <if test="job!=null">
            AND d."name" LIKE '%{job}%'
        </if>
        <if test="recommended!=null">
            AND d."name" LIKE '%{recommended}%'
        </if>
            AND d."name" LIKE '%{status}%'
        <if test="order!=null">
            ORDER BY md."id" ${order}
        </if>
        LIMIT ${length} OFFSET #{start}
    </select>

    <!--  分页查询数据量  -->

</mapper>
